{"ast":null,"code":"function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nvar container = document.querySelector('.container');\nvar seats = document.querySelectorAll('.row .seat:not(.occupied)');\nvar count = document.getElementById('count');\nvar price = document.getElementById('price');\nvar movieSelect = document.getElementById('movie');\nvar ticketPrice = +movieSelect.value;\n\nvar populateUI = function populateUI() {\n  var selectedSeats = JSON.parse(localStorage.getItem('selectedSeats'));\n  debugger; // if (selectedSeats !== null && selectedSeats.length > 0) {\n  //   seats.forEach((seat, index) => {\n  //     if (selectedSeats.indexOf(index) > -1) {\n  //       seat.classList.add('selected');\n  //     }\n  //   });\n  // }\n  // const selectedMovieIndex = localStorage.getItem('selectedMovieIndex');\n  // const selectedMoviePrice = localStorage.getItem('selectedMoviePrice');\n  // if (selectedMovieIndex !== null) {\n  //   movieSelect.selectedIndex = selectedMovieIndex;\n  // }\n  // if (selectedMoviePrice !== null) {\n  //   count.innerText = selectedSeats.length;\n  //   price.innerText = selectedSeats.length * +selectedMoviePrice;\n  // }\n};\n\npopulateUI();\n\nselectedMovie = function selectedMovie(movieIndex, moviePrice) {\n  localStorage.setItem('selectedMovieIndex', movieIndex);\n  localStorage.setItem('selectedMoviePrice', moviePrice);\n};\n\nvar updateSelectedSeatsCount = function updateSelectedSeatsCount() {\n  var selectedSeats = document.querySelectorAll('.row .selected');\n\n  var seatsIndex = _toConsumableArray(selectedSeats).map(function (seat) {\n    return _toConsumableArray(seats).indexOf(seat);\n  });\n\n  localStorage.setItem('selectedSeats', JSON.stringify(seatsIndex));\n  var selectedSeatsCount = selectedSeats.length;\n  count.innerText = selectedSeatsCount;\n  price.innerText = selectedSeatsCount * ticketPrice;\n}; // Seat select event\n\n\ncontainer.addEventListener('click', function (e) {\n  if (e.target.classList.contains('seat') && !e.target.classList.contains('occupied')) {\n    e.target.classList.toggle('selected');\n    updateSelectedSeatsCount();\n  }\n}); // Movie select event\n\nmovieSelect.addEventListener('change', function (e) {\n  ticketPrice = +e.target.value;\n  selectedMovie(e.target.selectedIndex, e.target.value);\n  updateSelectedSeatsCount();\n});\n$('#book-seat').on('click', function () {\n  updateSelectedSeatsCount();\n  var selectedMoviePrice = document.getElementById('movie').value,\n      selectedSeats = JSON.parse(localStorage.getItem('selectedSeats'));\n  var confirmBox = confirm(\"You have selected \".concat(selectedSeats.length, \" seats for a price of \").concat(selectedSeats.length * selectedMoviePrice));\n\n  if (confirmBox == true) {\n    var formData = {\n      \"seats\": localStorage.selectedSeats,\n      \"screening_id\": $(\"#screening-id\").val()\n    };\n    $.ajax({\n      url: '/bookings',\n      method: 'POST',\n      beforeSend: function beforeSend(xhr) {\n        xhr.setRequestHeader('X-CSRF-Token', $('meta[name=\"csrf-token\"]').attr('content'));\n      },\n      data: formData,\n      success: function success(resp) {\n        if (resp.success) {\n          alert(\"Booking successfully created.\");\n        }\n      }\n    });\n  } else {\n    alert(\"you pressed Cancel\");\n  }\n});","map":{"version":3,"sources":["/home/girish/Documents/Projects/simple-movie-booking/app/javascript/packs/booking.js"],"names":["container","document","querySelector","seats","querySelectorAll","count","getElementById","price","movieSelect","ticketPrice","value","populateUI","selectedSeats","JSON","parse","localStorage","getItem","selectedMovie","movieIndex","moviePrice","setItem","updateSelectedSeatsCount","seatsIndex","map","seat","indexOf","stringify","selectedSeatsCount","length","innerText","addEventListener","e","target","classList","contains","toggle","selectedIndex","$","on","selectedMoviePrice","confirmBox","confirm","formData","val","ajax","url","method","beforeSend","xhr","setRequestHeader","attr","data","success","resp","alert"],"mappings":";;;;;;;;;;;;AAAA,IAAMA,SAAS,GAAGC,QAAQ,CAACC,aAAT,CAAuB,YAAvB,CAAlB;AACA,IAAMC,KAAK,GAAGF,QAAQ,CAACG,gBAAT,CAA0B,2BAA1B,CAAd;AACA,IAAMC,KAAK,GAAGJ,QAAQ,CAACK,cAAT,CAAwB,OAAxB,CAAd;AACA,IAAMC,KAAK,GAAGN,QAAQ,CAACK,cAAT,CAAwB,OAAxB,CAAd;AAEA,IAAME,WAAW,GAAGP,QAAQ,CAACK,cAAT,CAAwB,OAAxB,CAApB;AACA,IAAIG,WAAW,GAAG,CAACD,WAAW,CAACE,KAA/B;;AAEA,IAAMC,UAAU,GAAG,SAAbA,UAAa,GAAM;AACvB,MAAMC,aAAa,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,eAArB,CAAX,CAAtB;AACA,WAFuB,CAGvB;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACD,CAtBD;;AAwBAL,UAAU;;AAEVM,aAAa,GAAG,uBAACC,UAAD,EAAaC,UAAb,EAA4B;AAC1CJ,EAAAA,YAAY,CAACK,OAAb,CAAqB,oBAArB,EAA2CF,UAA3C;AACAH,EAAAA,YAAY,CAACK,OAAb,CAAqB,oBAArB,EAA2CD,UAA3C;AACD,CAHD;;AAKA,IAAME,wBAAwB,GAAG,SAA3BA,wBAA2B,GAAM;AACrC,MAAMT,aAAa,GAAGX,QAAQ,CAACG,gBAAT,CAA0B,gBAA1B,CAAtB;;AAEA,MAAMkB,UAAU,GAAG,mBAAIV,aAAJ,EAAmBW,GAAnB,CAAuB,UAAAC,IAAI;AAAA,WAAI,mBAAIrB,KAAJ,EAAWsB,OAAX,CAAmBD,IAAnB,CAAJ;AAAA,GAA3B,CAAnB;;AAEAT,EAAAA,YAAY,CAACK,OAAb,CAAqB,eAArB,EAAsCP,IAAI,CAACa,SAAL,CAAeJ,UAAf,CAAtC;AAEA,MAAMK,kBAAkB,GAAGf,aAAa,CAACgB,MAAzC;AAEAvB,EAAAA,KAAK,CAACwB,SAAN,GAAkBF,kBAAlB;AACApB,EAAAA,KAAK,CAACsB,SAAN,GAAkBF,kBAAkB,GAAGlB,WAAvC;AACD,CAXD,C,CAaA;;;AACAT,SAAS,CAAC8B,gBAAV,CAA2B,OAA3B,EAAoC,UAAAC,CAAC,EAAI;AACvC,MACEA,CAAC,CAACC,MAAF,CAASC,SAAT,CAAmBC,QAAnB,CAA4B,MAA5B,KACA,CAACH,CAAC,CAACC,MAAF,CAASC,SAAT,CAAmBC,QAAnB,CAA4B,UAA5B,CAFH,EAGE;AACAH,IAAAA,CAAC,CAACC,MAAF,CAASC,SAAT,CAAmBE,MAAnB,CAA0B,UAA1B;AAEAd,IAAAA,wBAAwB;AACzB;AACF,CATD,E,CAWA;;AACAb,WAAW,CAACsB,gBAAZ,CAA6B,QAA7B,EAAuC,UAAAC,CAAC,EAAI;AAC1CtB,EAAAA,WAAW,GAAG,CAACsB,CAAC,CAACC,MAAF,CAAStB,KAAxB;AACAO,EAAAA,aAAa,CAACc,CAAC,CAACC,MAAF,CAASI,aAAV,EAAyBL,CAAC,CAACC,MAAF,CAAStB,KAAlC,CAAb;AAEAW,EAAAA,wBAAwB;AACzB,CALD;AAOAgB,CAAC,CAAC,YAAD,CAAD,CAAgBC,EAAhB,CAAmB,OAAnB,EAA4B,YAAU;AACpCjB,EAAAA,wBAAwB;AACxB,MAAMkB,kBAAkB,GAAGtC,QAAQ,CAACK,cAAT,CAAwB,OAAxB,EAAiCI,KAA5D;AAAA,MACME,aAAa,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,eAArB,CAAX,CADtB;AAEA,MAAIwB,UAAU,GAAGC,OAAO,6BAAsB7B,aAAa,CAACgB,MAApC,mCAAmEhB,aAAa,CAACgB,MAAd,GAAuBW,kBAA1F,EAAxB;;AACA,MAAIC,UAAU,IAAI,IAAlB,EAAwB;AACtB,QAAKE,QAAQ,GAAG;AACV,eAAS3B,YAAY,CAACH,aADZ;AAEV,sBAAgByB,CAAC,CAAC,eAAD,CAAD,CAAmBM,GAAnB;AAFN,KAAhB;AAIAN,IAAAA,CAAC,CAACO,IAAF,CAAO;AACLC,MAAAA,GAAG,EAAE,WADA;AAELC,MAAAA,MAAM,EAAE,MAFH;AAGLC,MAAAA,UAAU,EAAE,oBAASC,GAAT,EAAc;AAACA,QAAAA,GAAG,CAACC,gBAAJ,CAAqB,cAArB,EAAqCZ,CAAC,CAAC,yBAAD,CAAD,CAA6Ba,IAA7B,CAAkC,SAAlC,CAArC;AAAmF,OAHzG;AAILC,MAAAA,IAAI,EAAET,QAJD;AAKLU,MAAAA,OAAO,EAAE,iBAACC,IAAD,EAAU;AACjB,YAAIA,IAAI,CAACD,OAAT,EAAkB;AAChBE,UAAAA,KAAK,CAAC,+BAAD,CAAL;AACD;AACF;AATI,KAAP;AAWD,GAhBD,MAgBO;AACLA,IAAAA,KAAK,CAAC,oBAAD,CAAL;AACD;AACF,CAxBD","sourcesContent":["const container = document.querySelector('.container');\nconst seats = document.querySelectorAll('.row .seat:not(.occupied)');\nconst count = document.getElementById('count');\nconst price = document.getElementById('price');\n\nconst movieSelect = document.getElementById('movie');\nlet ticketPrice = +movieSelect.value;\n\nconst populateUI = () => {\n  const selectedSeats = JSON.parse(localStorage.getItem('selectedSeats'));\n  debugger\n  // if (selectedSeats !== null && selectedSeats.length > 0) {\n  //   seats.forEach((seat, index) => {\n  //     if (selectedSeats.indexOf(index) > -1) {\n  //       seat.classList.add('selected');\n  //     }\n  //   });\n  // }\n\n  // const selectedMovieIndex = localStorage.getItem('selectedMovieIndex');\n  // const selectedMoviePrice = localStorage.getItem('selectedMoviePrice');\n\n  // if (selectedMovieIndex !== null) {\n  //   movieSelect.selectedIndex = selectedMovieIndex;\n  // }\n\n  // if (selectedMoviePrice !== null) {\n  //   count.innerText = selectedSeats.length;\n  //   price.innerText = selectedSeats.length * +selectedMoviePrice;\n  // }\n};\n\npopulateUI();\n\nselectedMovie = (movieIndex, moviePrice) => {\n  localStorage.setItem('selectedMovieIndex', movieIndex);\n  localStorage.setItem('selectedMoviePrice', moviePrice);\n};\n\nconst updateSelectedSeatsCount = () => {\n  const selectedSeats = document.querySelectorAll('.row .selected');\n\n  const seatsIndex = [...selectedSeats].map(seat => [...seats].indexOf(seat));\n\n  localStorage.setItem('selectedSeats', JSON.stringify(seatsIndex));\n\n  const selectedSeatsCount = selectedSeats.length;\n\n  count.innerText = selectedSeatsCount;\n  price.innerText = selectedSeatsCount * ticketPrice;\n};\n\n// Seat select event\ncontainer.addEventListener('click', e => {\n  if (\n    e.target.classList.contains('seat') &&\n    !e.target.classList.contains('occupied')\n  ) {\n    e.target.classList.toggle('selected');\n\n    updateSelectedSeatsCount();\n  }\n});\n\n// Movie select event\nmovieSelect.addEventListener('change', e => {\n  ticketPrice = +e.target.value;\n  selectedMovie(e.target.selectedIndex, e.target.value);\n\n  updateSelectedSeatsCount();\n});\n\n$('#book-seat').on('click', function(){\n  updateSelectedSeatsCount();\n  const selectedMoviePrice = document.getElementById('movie').value,\n        selectedSeats = JSON.parse(localStorage.getItem('selectedSeats'));\n  let confirmBox = confirm(`You have selected ${selectedSeats.length} seats for a price of ${selectedSeats.length * selectedMoviePrice}`);\n  if (confirmBox == true) {\n    let  formData = {\n          \"seats\": localStorage.selectedSeats,\n          \"screening_id\": $(\"#screening-id\").val(),\n      };\n    $.ajax({\n      url: '/bookings',\n      method: 'POST',\n      beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name=\"csrf-token\"]').attr('content'))},\n      data: formData,\n      success: (resp) => {\n        if (resp.success) {\n          alert(\"Booking successfully created.\")\n        }\n      },\n    });\n  } else {\n    alert(\"you pressed Cancel\")\n  }\n});\n\n"]},"metadata":{},"sourceType":"module"}